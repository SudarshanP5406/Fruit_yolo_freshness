<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fruit Freshness Detector</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://fonts.cdnfonts.com/css/sf-pro-display">
  <style>
    * { font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
    body { background-color: black; overflow: hidden; }

    .video-container {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: -1;
      overflow: hidden;
    }
    video {
      width: 100%; height: 100%;
      object-fit: cover;
      filter: blur(10px) brightness(40%);
      transition: opacity 1.5s ease-in-out;
      position: absolute; top: 0; left: 0;
    }
    .hidden { opacity: 0; pointer-events: none; }
    .visible { opacity: 1; pointer-events: auto; }

    .btn-animated {
      background: linear-gradient(90deg, #00FF87, #60EFFA);
      color: black;
      padding: 0.8rem 2rem;
      border-radius: 2rem;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    .btn-animated:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 0 20px rgba(0, 255, 150, 0.6);
    }
  </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen text-white text-center">

  <!-- Background video sequence -->
  <div class="video-container">
    <video id="video1" autoplay muted class="visible">
      <source src="{{ url_for('static', filename='background1.mp4') }}" type="video/mp4">
    </video>
    <video id="video2" autoplay muted class="hidden">
      <source src="{{ url_for('static', filename='background2.mp4') }}" type="video/mp4">
    </video>
  </div>

  <script>
    const v1 = document.getElementById("video1");
    const v2 = document.getElementById("video2");
    v1.onended = () => { v1.classList.add('hidden'); v2.classList.remove('hidden'); v2.play(); };
    v2.onended = () => { v2.classList.add('hidden'); v1.classList.remove('hidden'); v1.play(); };
  </script>

  <!-- Main UI -->
  <div class="z-10 bg-black/50 backdrop-blur-2xl rounded-3xl p-10 shadow-2xl w-[90%] md:w-[480px]">
    <h1 class="text-3xl font-semibold mb-2 text-green-300">üçè Fruit Freshness Detector</h1>
    <p class="text-gray-400 mb-8">Detect freshness using YOLOv8 ‚Äî Upload or use your camera!</p>

    <form id="uploadForm" action="/" method="post" enctype="multipart/form-data" class="space-y-4">
  <!-- Hidden file input -->
  <input type="file" id="fileInput" name="file" accept="image/*" class="hidden" required>

  <div class="flex justify-center gap-6 mt-6">
    <!-- Upload button triggers file picker -->
    <button type="button" id="uploadBtn" class="btn-animated">Upload Image</button>
    <a href="/camera" class="btn-animated">Live Camera</a>
  </div>
</form>

<script>
  const fileInput = document.getElementById('fileInput');
  const uploadBtn = document.getElementById('uploadBtn');
  const form = document.getElementById('uploadForm');

  uploadBtn.addEventListener('click', () => {
    fileInput.click(); // open file picker
  });

  fileInput.addEventListener('change', () => {
    if (fileInput.files.length > 0) {
      form.submit(); // auto-submit after selection
    }
  });
</script>


    {% if label %}
    <div class="mt-8 p-4 bg-gray-900/80 rounded-2xl shadow-inner">
      <h2 class="text-xl font-semibold text-green-400 mb-2">Prediction: {{ label }}</h2>
      <img src="{{ result_image }}" alt="Result Image" class="w-48 h-48 object-cover mx-auto rounded-xl shadow-md border border-gray-700">
    </div>
    {% endif %}
  </div>

  <footer class="mt-10 text-gray-500 text-xs">Made with ‚ù§Ô∏è by Sudarshan P</footer>
</body>
</html>
